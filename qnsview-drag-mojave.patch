From cd08753d3e2ac02663ba0ab588d7d926f7438475 Mon Sep 17 00:00:00 2001
From: =?utf8?q?Morten=20Johan=20S=C3=B8rvig?= <morten.sorvig@qt.io>
Date: Sun, 17 Jun 2018 11:07:37 +0200
Subject: [PATCH] =?utf8?q?cocoa:=20Don=E2=80=99t=20trigger=20security=20di?=
 =?utf8?q?alog=20on=20drag?=
MIME-Version: 1.0
Content-Type: text/plain; charset=utf8
Content-Transfer-Encoding: 8bit

macOS 10.14+ will display an âAccessibility Accessâ
security dialog if we generate mouse events, so donât.

Task-number: QTBUG-68830
Change-Id: If832ca3cd49ec6bdad1a8188feab884b6562e9d2
Reviewed-by: Tor Arne VestbÃ¸ <tor.arne.vestbo@qt.io>
---
 src/plugins/platforms/cocoa/qnsview.mm | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/plugins/platforms/cocoa/qnsview.mm b/src/plugins/platforms/cocoa/qnsview.mm
index c88ffc76d7a..1c400a1ec97 100644
--- a/src/plugins/platforms/cocoa/qnsview.mm
+++ b/src/plugins/platforms/cocoa/qnsview.mm
@@ -1967,20 +1967,6 @@ static QPoint mapWindowCoordinates(QWind
 
     // change the cursor
     [nativeCursor set];
-
-    // Make sure the cursor is updated correctly if the mouse does not move and window is under cursor
-    // by creating a fake move event
-    if (m_updatingDrag)
-        return;
-
-    const QPoint mousePos(QCursor::pos());
-    CGEventRef moveEvent(CGEventCreateMouseEvent(
-        NULL, kCGEventMouseMoved,
-        CGPointMake(mousePos.x(), mousePos.y()),
-        kCGMouseButtonLeft // ignored
-    ));
-    CGEventPost(kCGHIDEventTap, moveEvent);
-    CFRelease(moveEvent);
 }
 
 - (NSDragOperation)draggingEntered:(id <NSDraggingInfo>)sender
-- 
2.16.3

